# Объяснение нейросети Встречного распространения (Counterpropagation Network)

**Нейросеть встречного распространения (Counterpropagation Network, CPN)** — это гибридная нейронная сеть, которая сочетает в себе элементы самоорганизующейся карты (SOM, например, карты Кохонена) и классической нейронной сети прямого распространения. CPN состоит из двух слоёв:

- **Карта Кохонена (входной слой)** — используется для кластеризации входных данных.
- **Слой обратного распространения** — связывает выходной слой с картой Кохонена для коррекции результатов.

### Основная идея сети встречного распространения заключается в том, что:
1. **Входные данные** кластеризуются с помощью карты Кохонена на первом шаге.
2. **Обратное распространение** используется для обучения сети на основе известных целевых значений, что позволяет корректировать выходы на последнем слое.

## Структура CPN:
- **Входной слой**: Подаются входные данные.
- **Карта Кохонена**: Кластеризует входные данные. Здесь определяются нейроны-победители.
- **Обратное распространение**: После выбора победителя и его ближайших соседей их результаты корректируются через слой обратного распространения.

## Этапы работы:
1. **Прямое распространение**: Входные данные подаются на карту Кохонена. Каждый нейрон карты Кохонена вычисляет расстояние до входных данных. Выбирается победитель.
2. **Коррекция по карте Кохонена**: Победитель и его соседи обновляют свои веса, чтобы лучше соответствовать входным данным.
3. **Прямое распространение на выходной слой**: Веса между картой Кохонена и выходным слоем обновляются через стандартное обратное распространение ошибки на основе целевого значения.
4. **Обратное распространение**: Ошибка выходного слоя используется для корректировки весов между картой Кохонена и выходным слоем.

## Поэтапный процесс:
1. **Инициализируем карту Кохонена**:
   - Для каждого входного вектора выбираем нейрон-победитель.
   - Обновляем веса карты Кохонена для победителя и его соседей.
   
2. **Добавляем выходной слой**:
   - Этот слой будет обучаться с помощью целевых значений.
   - После того как мы выбрали нейрон-победитель на карте Кохонена, мы передаём его выход на следующий (выходной) слой.
   
3. **Прямое распространение на выходной слой**:
   - Применяем обычное умножение весов на входные данные для выхода второго слоя.
   - Используем активационную функцию для выхода.
   
4. **Обратное распространение ошибки**:
   - Вычисляем ошибку между целевым значением и предсказанным выходом.
   - Используем градиентный спуск для обновления весов между картой Кохонена и выходным слоем.

---



