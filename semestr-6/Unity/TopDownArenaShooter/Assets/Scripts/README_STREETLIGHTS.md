# Инструкция по настройке системы уличных фонарей

## Обзор системы

Система уличных фонарей позволяет размещать на карте статичные источники света, которые работают аналогично фонарику игрока, освещая определенные области и делая врагов видимыми в этих зонах. Это создает интересные тактические элементы на карте, где игрок может использовать "безопасные зоны" для наблюдения за врагами.

## Компоненты системы

Система состоит из следующих компонентов:

1. **StreetLight** - основной компонент уличного фонаря
2. **StreetLightManager** - менеджер, управляющий всеми уличными фонарями
3. **Интеграция с FogOfWar** - расширение системы тумана войны для поддержки уличных фонарей
4. **Интеграция с EnemyVisibility** - расширение системы видимости врагов для учета уличных фонарей

## Настройка уличных фонарей

### Шаг 1: Создание менеджера уличных фонарей

1. Создайте пустой GameObject в сцене:
   - Правый клик в Hierarchy -> Create Empty
   - Назовите его `StreetLightManager`

2. Добавьте компонент StreetLightManager:
   - Add Component -> Scripts -> StreetLightManager
   - Настройте параметры:
     - Find Lights At Start: true (автоматический поиск фонарей при старте)
     - Affect Enemy Visibility: true (влияние на видимость врагов)

### Шаг 2: Создание уличного фонаря

1. Создайте пустой GameObject:
   - Правый клик в Hierarchy -> Create Empty
   - Назовите его `StreetLight_1` (или другое подходящее имя)
   - Расположите его в нужной позиции на сцене

2. Добавьте компонент StreetLight:
   - Add Component -> Scripts -> StreetLight
   - Настройте параметры:
     - Light Distance: дальность света (например, 15)
     - Light Angle: угол конуса света (например, 60)
     - Light Color: цвет света (например, желтый)
     - Light Intensity: интенсивность (например, 2.5)
     - Gizmo Size/Color: настройки отображения в редакторе

3. Настройте направление фонаря:
   - В обычном режиме редактора Unity, выберите объект фонаря
   - Используйте инструменты вращения для установки нужного направления
   - Вы можете увидеть направление фонаря с помощью гизмо в редакторе
   - Для более точной настройки можно создать дочерний объект с моделью фонаря

### Шаг 3: Создание визуальной модели (опционально)

1. Добавьте 3D модель фонаря:
   - Можно использовать простые примитивы (цилиндр, куб) для создания фонаря
   - Правый клик на объекте StreetLight -> 3D Object -> Cylinder (для столба)
   - Добавьте еще один 3D объект для светильника

2. Настройте материалы:
   - Создайте материалы для столба и светильника
   - Добавьте эмиссию для материала светильника с цветом, соответствующим цвету света

### Шаг 4: Повторение для других фонарей

1. Повторите шаги 2-3 для создания нужного количества фонарей, или:
2. Дублируйте существующие фонари и изменяйте их позиции и направления:
   - Выберите фонарь и нажмите Ctrl+D для дублирования
   - Переместите и настройте дубликат

### Шаг 5: Проверка интеграции с системой тумана войны

1. Убедитесь, что на сцене есть объект FogOfWar:
   - Выберите объект FogOfWar в Hierarchy
   - Проверьте настройки:
     - Include Street Lights: true (учитывать уличные фонари)
     - Street Light Color: цвет света уличных фонарей

## Советы по размещению фонарей

1. **Стратегические локации:**
   - Размещайте фонари в ключевых точках карты
   - Используйте для освещения важных ресурсов или точек прохода

2. **Игровой баланс:**
   - Не размещайте слишком много фонарей, чтобы не уменьшать значимость фонарика игрока
   - Создавайте как освещенные зоны, так и темные участки для разнообразия геймплея

3. **Направление и угол:**
   - Направляйте фонари в сторону от базы для раннего обнаружения врагов
   - Используйте разные углы и дальности для создания интересных узоров освещения

## Отладка и тестирование

1. В Play Mode проверьте:
   - Корректно ли отображаются враги в зоне освещения фонарей
   - Плавно ли появляются/исчезают враги при входе/выходе из зоны света
   - Работают ли фонари вместе с фонариком игрока

2. Возможные проблемы и решения:
   - Если враги не становятся видимыми в свете фонарей, проверьте affectEnemyVisibility в StreetLightManager
   - Если свет не отображается в тумане войны, проверьте includeStreetLights в FogOfWar

## Программное управление фонарями

```csharp
// Получение менеджера фонарей
StreetLightManager lightManager = FindObjectOfType<StreetLightManager>();

// Включение/выключение всех фонарей
lightManager.EnableAllLights();
lightManager.DisableAllLights();

// Получение ближайшего фонаря к игроку
StreetLight nearest = lightManager.GetNearestStreetLight(player.position);

// Включение/выключение конкретного фонаря
if (nearest != null)
{
    nearest.spotLight.enabled = false; // Выключаем ближайший фонарь
}
``` 