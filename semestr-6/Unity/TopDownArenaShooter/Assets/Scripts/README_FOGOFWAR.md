# Инструкция по настройке системы фонарика и тумана войны

## 1. Настройка шейдера и материала

1. Создайте папку `Shaders` в директории `Assets`, если её ещё нет.
2. Убедитесь, что файл `FogOfWarShader.shader` находится в папке `Assets/Shaders`.
3. Создайте новый материал:
   - Правый клик в Project View -> Create -> Material
   - Назовите материал `FogOfWarMaterial`
   - В Inspector выберите шейдер Custom/FogOfWarShader
   - Настройте параметры:
     - Global Darkness: 0.9 (или как вам удобнее)
     - Light Color: белый

## 2. Настройка объекта тумана войны

1. В Unity создайте пустой GameObject:
   - Правый клик в Hierarchy -> Create Empty
   - Назовите его `FogOfWar`
2. Добавьте к объекту компонент `FogOfWar.cs`:
   - Add Component -> Scripts -> FogOfWar
3. Настройте компонент в Inspector:
   - Fog Of War Material: перетащите созданный ранее материал `FogOfWarMaterial`
   - Player: перетащите объект игрока
   - Global Darkness: установите значение от 0 до 1 (рекомендуется 0.8-0.95)

4. Создайте квадратный плоский объект (плоскость), который будет покрывать всю игровую зону:
   - Правый клик в Hierarchy -> 3D Object -> Quad
   - Назовите его `FogOfWarPlane`
   - Переместите объект немного выше земли (например, Y = 0.5)
   - Увеличьте размер, чтобы покрыть всю игровую область
   - Поверните так, чтобы он был параллелен земле (rotation X = 90)
5. Присвойте материал `FogOfWarMaterial` объекту `FogOfWarPlane`:
   - Выберите объект в Hierarchy
   - В Mesh Renderer компоненте, в поле Material, перетащите материал FogOfWarMaterial
6. Создайте новый Layer (слой) для тумана войны:
   - Edit -> Project Settings -> Tags and Layers
   - Добавьте новый слой, например "FogOfWar"
   - Назначьте этот слой объекту `FogOfWarPlane`
7. Настройте объект `FogOfWarPlane`:
   - Убедитесь, что он не имеет коллайдера (или отключите компонент Collider)
   - Установите слой "FogOfWar" для этого объекта

## 3. Настройка фонарика игрока

1. Выберите объект игрока в Hierarchy.
2. Добавьте компонент `PlayerFlashlight.cs`:
   - Add Component -> Scripts -> PlayerFlashlight
3. Настройте параметры фонарика:
   - Max Light Distance: дальность света (например, 10)
   - Light Angle: угол освещения (например, 60)
   - Light Color: цвет света (обычно белый)
   - Light Intensity: интенсивность света (например, 2)
4. Вы можете создать объект Light внутри игрока для визуализации фонарика (опционально):
   - Правый клик на объекте игрока -> Create Empty
   - Назовите его "FlashlightLight"
   - Add Component -> Light
   - Установите тип Light: Spot
   - Настройте угол и дальность как в компоненте PlayerFlashlight
   - Перетащите этот объект в поле SpotLight компонента PlayerFlashlight

## 4. Настройка врагов

1. Для каждого префаба врага:
   - Убедитесь, что у объекта врага есть компонент EnemyVisibility, или он будет добавлен автоматически при создании через EnemySpawner.
   - Или вручную добавьте компонент `EnemyVisibility` к каждому врагу:
     - Select enemy GameObject -> Add Component -> Scripts -> EnemyVisibility

## 5. Тестирование

1. Запустите игру.
2. Проверьте:
   - Карта должна быть затемнена, видны только силуэты уровня
   - Враги должны быть невидимы в темноте
   - При освещении фонариком враги должны становиться видимыми
   - Нажатие клавиши F должно включать/выключать фонарик

## Возможные проблемы и решения

1. **Не видно тумана войны:**
   - Убедитесь, что объект FogOfWarPlane находится выше всех остальных объектов
   - Проверьте, что материал правильно присвоен и шейдер выбран

2. **Враги всегда видны:**
   - Проверьте, что компонент EnemyVisibility добавлен к врагам
   - Убедитесь, что метод IsInLightArea в FogOfWar работает правильно

3. **Ошибки компиляции шейдера:**
   - В Unity версиях 2019+ могут потребоваться дополнительные настройки для Render Pipeline.
   - Для URP/HDRP может потребоваться адаптировать шейдер.

## Дополнительные настройки

- Вы можете модифицировать параметры тумана войны в реальном времени для создания эффектов разной интенсивности.
- Настройте интенсивность фонарика и угол освещения для баланса игры.
- Попробуйте добавить улучшения для фонарика (увеличенная дальность, ширина луча) в систему прокачки.